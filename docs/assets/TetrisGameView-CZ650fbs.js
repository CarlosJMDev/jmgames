import{r as w,j as B,a as T,c as m,e as n,t as c,u as o,i as L,h as d,l as Q,F as b,g as I,n as W,f as N,o as Z,s as ee,p as te,m as C}from"./index-DOl8CUd0.js";const k=20,v=10,g=w(Array.from({length:k},()=>Array(v).fill(0))),R=[[[1,1,1,1]],[[2,2],[2,2]],[[0,3,0],[3,3,3]],[[0,4,4],[4,4,0]],[[5,5,0],[0,5,5]],[[6,0,0],[6,6,6]],[[0,0,7],[7,7,7]]],h=w(!1),x=w(!1),P=w(0),A=w(1),H=()=>{const t=Math.floor(Math.random()*R.length);return R[t]},i=w({shape:H(),x:Math.floor(v/2)-Math.floor(H()[0].length/2),y:0}),M=(t,e,s)=>{for(let l=0;l<s.length;l++)for(let r=0;r<s[l].length;r++)if(s[l][r]!==0){const u=t+r,a=e+l;if(u<0||u>=v||a>=k||a>=0&&g.value[a][u]!==0)return!0}return!1},ne=t=>t[0].map((e,s)=>t.map(l=>l[s])).reverse(),S=()=>{if(h.value||x.value)return;const t=ne(i.value.shape);let e=i.value.x;for(;M(e,i.value.y,t);)if(e>Math.floor(v/2)?e--:e++,e<0||e>=v)return;M(e,i.value.y,t)||(i.value.shape=t,i.value.x=e)},j=t=>{if(h.value||x.value)return;const e=i.value.x+t;M(e,i.value.y,i.value.shape)||(i.value.x=e)},se=()=>{const{shape:t,x:e,y:s}=i.value;t.forEach((l,r)=>{l.forEach((u,a)=>{u!==0&&s+r>=0&&s+r<k&&e+a>=0&&e+a<v&&(g.value[s+r][e+a]=u)})})},oe=()=>{let t=0;g.value=g.value.filter(e=>{const s=e.every(l=>l!==0);return s&&t++,!s});for(let e=0;e<t;e++)g.value.unshift(Array(v).fill(0));P.value+=t*10,A.value=Math.floor(P.value/50)+1,$()},q=()=>{const t=H(),e=Math.floor(v/2)-Math.floor(t[0].length/2),s=0;if(M(e,s,t)){x.value=!0,p&&clearInterval(p);return}i.value.shape=t,i.value.x=e,i.value.y=s},D=()=>{if(h.value||x.value)return;const t=i.value.y+1;M(i.value.x,t,i.value.shape)?(se(),oe(),q()):i.value.y=t};let p;const $=()=>{const t=Math.floor(A.value/2)*100,e=Math.max(1e3-t,300);p&&clearInterval(p),p=setInterval(()=>{D()},e)},V=()=>{x.value||(h.value=!h.value,h.value?p&&clearInterval(p):$())},X=t=>{if(t.code==="KeyP"){V();return}if(!(h.value||x.value))switch(t.code){case"ArrowLeft":j(-1);break;case"ArrowRight":j(1);break;case"ArrowDown":D();break;case"Space":t.preventDefault(),S();break}},re=()=>{g.value=Array.from({length:k},()=>Array(v).fill(0)),x.value=!1,h.value=!1,q(),$(),window.addEventListener("keydown",X)},le=()=>{p&&clearInterval(p),window.removeEventListener("keydown",X)},ae=B(()=>{const t=g.value.map(r=>r.slice()),{shape:e,x:s,y:l}=i.value;return e.forEach((r,u)=>{r.forEach((a,f)=>{if(a!==0){const _=l+u,y=s+f;_>=0&&_<k&&y>=0&&y<v&&(t[_][y]=a)}})}),t});function ie(){return{grid:ae,currentPiece:i,paused:h,gameOver:x,score:P,level:A,rotatePiece:S,movePiece:j,moveDown:D,startGravity:$,initTetris:re,cleanupTetris:le,togglePause:V}}const ce={class:"bg-gray-800 p-4 rounded text-white mb-4 flex justify-between w-full max-w-md"},ue={class:"text-2xl font-bold"},de={class:"text-xl"},fe={class:"text-2xl font-bold"},me={class:"text-xl"},ve=T({__name:"InfoComponent",props:{score:{type:Number,required:!0},level:{type:Number,required:!0},paused:{type:Boolean,required:!1}},emits:["pause-game"],setup(t,{emit:e}){const s=e,l=()=>s("pause-game"),r=L("i18n");return(u,a)=>(d(),m("div",ce,[n("div",null,[n("h2",ue,c(o(r).t("tetris.score")),1),n("p",de,c(t.score),1)]),n("button",{onClick:l,class:"btn"},c(t.paused?o(r).t("tetris.resume"):o(r).t("tetris.pause")),1),n("div",null,[n("h2",fe,c(o(r).t("tetris.level")),1),n("p",me,c(t.level),1)])]))}}),he={class:"w-2xl h-3xl p-10 max-w-md"},pe=T({__name:"BoardComponent",props:{grid:{type:Array,required:!0}},setup(t){const e=t,s=B(()=>{var l;return{gridTemplateColumns:`repeat(${((l=e.grid[0])==null?void 0:l.length)||10}, minmax(0, 1fr))`}});return(l,r)=>(d(),m("main",he,[n("div",{class:"grid gap-0.5 justify-items-center border-2 border-gray-600 p-1",style:Q(s.value)},[(d(!0),m(b,null,I(t.grid,(u,a)=>(d(),m(b,{key:a},[(d(!0),m(b,null,I(u,(f,_)=>(d(),m("div",{key:`${a}-${_}`,class:W(["w-8 h-8 border border-gray-700",f!==0?"bg-green-600":"bg-gray-800"])},null,2))),128))],64))),128))],4)]))}}),_e={class:"flex justify-center items-center gap-4 my-4"},xe=T({__name:"ControlsComponent",emits:["move","rotate","down"],setup(t,{emit:e}){const s=e,l=()=>s("move",-1),r=()=>s("move",1),u=()=>s("down"),a=()=>s("rotate"),f=L("i18n");return(_,y)=>(d(),m("div",_e,[n("button",{onClick:l,class:"bg-blue-500 text-white px-4 py-2 rounded"},c(o(f).t("tetris.left")),1),n("button",{onClick:a,class:"bg-green-500 text-white px-4 py-2 rounded"},c(o(f).t("tetris.rotate")),1),n("button",{onClick:r,class:"bg-blue-500 text-white px-4 py-2 rounded"},c(o(f).t("tetris.right")),1),n("button",{onClick:u,class:"bg-red-500 text-white px-4 py-2 rounded"},c(o(f).t("tetris.down")),1)]))}}),ge={class:"text-center text-white text-6xl font-retro"},ye={class:"flex flex-col justify-center items-center gap-2"},we={class:"font-bold text-white"},be={class:"text-lg"},Me={class:"font-bold text-white"},Te={class:"text-lg"},ke=T({__name:"GameEndComponent",props:{score:{type:Number,required:!0},level:{type:Number,required:!0}},emits:["init-game"],setup(t,{emit:e}){const s=e,l=()=>s("init-game"),r=L("i18n");return(u,a)=>(d(),m(b,null,[n("h1",ge,c(o(r).t("tetris.gameOver")),1),n("div",ye,[n("p",we,[N(c(o(r).t("tetris.scoreText"))+" ",1),n("span",be,c(t.score),1)]),n("p",Me,[N(c(o(r).t("tetris.levelText"))+" ",1),n("span",Te,c(t.level),1)])]),n("button",{class:"font-bold text-white cursor-pointer border border-yellow-400 rounded-lg p-2 bg-yellow-600",onClick:l},c(o(r).t("common.newGame")),1)],64))}}),Le={class:"text-3xl font-extrabold text-white mt-10"},$e={key:1,class:"w-full h-full p-2 flex flex-col lg:flex-row items-center justify-center"},Ce={class:"flex flex-col justify-center items-center mt-2"},Pe={class:"flex flex-col gap-2 items-center justify-center"},He={class:"p-6 bg-gray-800 text-white rounded-md max-w-md mx-auto my-4"},je={class:"text-2xl font-bold mb-4"},Ae={class:"list-disc pl-5"},De=["innerHTML"],Ee=["innerHTML"],Ge=["innerHTML"],Ie=["innerHTML"],Ne=["innerHTML"],Re=["innerHTML"],Be={class:"mt-2 font-bold text-center"},Ve=T({__name:"TetrisGameView",setup(t){const e=L("i18n"),{grid:s,paused:l,gameOver:r,score:u,level:a,rotatePiece:f,movePiece:_,moveDown:y,initTetris:E,cleanupTetris:O,togglePause:Y}=ie();Z(()=>{E()}),ee(()=>{O()});const z=G=>{_(G)},F=()=>{f()},K=()=>{y()},U=()=>{Y()},J=()=>{E()};return(G,Se)=>(d(),m(b,null,[n("h1",Le,c(o(e).t("tetris.title")),1),o(r)?(d(),te(ke,{key:0,onInitGame:J,score:o(u),level:o(a)},null,8,["score","level"])):(d(),m("div",$e,[n("div",Ce,[C(pe,{grid:o(s)},null,8,["grid"])]),n("div",Pe,[C(xe,{onMove:z,onRotate:F,onDown:K}),C(ve,{score:o(u),level:o(a),paused:o(l),onPauseGame:U},null,8,["score","level","paused"]),n("div",He,[n("h2",je,c(o(e).t("tetris.instructions")),1),n("ul",Ae,[n("li",{innerHTML:o(e).t("tetris.moveLeft")},null,8,De),n("li",{innerHTML:o(e).t("tetris.moveRight")},null,8,Ee),n("li",{innerHTML:o(e).t("tetris.dropPiece")},null,8,Ge),n("li",{innerHTML:o(e).t("tetris.rotatePiece")},null,8,Ie),n("li",{innerHTML:o(e).t("tetris.resumePause")},null,8,Ne)]),n("p",{class:"mt-4",innerHTML:o(e).t("tetris.objective")},null,8,Re),n("p",Be,c(o(e).t("tetris.goodLuck")),1)])])]))],64))}});export{Ve as default};
